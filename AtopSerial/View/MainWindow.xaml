<Window
    x:Class="AtopSerial.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:hc="https://handyorg.github.io/handycontrol"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:fa="http://schemas.fontawesome.io/icons/"
    xmlns:local="clr-namespace:AtopSerial"
    xmlns:local_page="clr-namespace:AtopSerial.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="{DynamicResource AppTitle}"
    Width="1000"
    Height="620"
    Activated="Window_Activated"
    Deactivated="Window_Deactivated"
    Loaded="Window_Loaded"
    Closing="MainWindow_Closing"
    StateChanged="MainWindow_StateChanged"
    mc:Ignorable="d">
    <Window.Style>
        <Style BasedOn="{StaticResource {x:Type Window}}" TargetType="Window" />
    </Window.Style>
    <Window.Resources>
        <RoutedUICommand x:Key="SendUartData" Text="SendUartData" />
        <local_page:boolVisibeConverter x:Key="boolVisibeConverter" />
        <local_page:boolNotVisibeConverter x:Key="boolNotVisibeConverter" />
        <local_page:graphSwIconConverter x:Key="GraphSwIconConverter" />
        <local_page:dataMonitorSelectShowIconConverter x:Key="DataMonitorSelectShowConverter" />
        <local_page:dataMonitorAllSelectIconConverter x:Key="DataMonitorAllSelectConverter" />
    </Window.Resources>
    <Window.InputBindings>
        <KeyBinding
            Key="Return"
            Command="{StaticResource SendUartData}"
            Gesture="Ctrl+Return" />
    </Window.InputBindings>
    <Window.CommandBindings>
        <CommandBinding Command="{StaticResource SendUartData}" Executed="SendUartData_Executed" />
    </Window.CommandBindings>
    <Grid Name="MainGrid" 
          IsEnabled="False" 
          Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350" MinWidth="360"/>
            <ColumnDefinition Width="3" />
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <TabControl 
            Margin="0, 0, 0, 0"
            Grid.Row="0"
            Grid.Column="0"
            Name="CardTabControl"
            SelectionChanged="CardTabControl_Click">
            <!--  脚本、快捷发送  -->
            <TabItem 
                Header="{DynamicResource QuickSendCard}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition  Height="*" />
                        <RowDefinition  Height="35" />
                    </Grid.RowDefinitions>
                    <ScrollViewer 
                        Name = "QuickScrollViewer"
                        Grid.Row="0"
                        Grid.Column="0"
                        VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="13*" />
                                    <ColumnDefinition Width="7*"/>
                                    <ColumnDefinition Width="auto" />
                                </Grid.ColumnDefinitions>
                                <Menu 
                                    Name="QuiclList" 
                                    PreviewMouseRightButtonDown="QuiclList_PreviewMouseRightButtonDown"
                                    MouseDown="QuickListNameStackPanel_MouseRightButtonDown"
                                    Grid.Column="0" 
                                    HorizontalAlignment="Left">
                                    <MenuItem ToolTip="{DynamicResource QuickSendChangeList}">
                                        <MenuItem.Header>
                                            <TextBlock Name="QuickListPageTextBlock" Text="___" />
                                        </MenuItem.Header>
                                        <MenuItem
                                        Name="QuiclListName0"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName0}"
                                        Tag="0" />
                                        <MenuItem
                                        Name="QuiclListName1"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName1}"
                                        Tag="1" />
                                        <MenuItem
                                        Name="QuiclListName2"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName2}"
                                        Tag="2" />
                                        <MenuItem
                                        Name="QuiclListName3"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName3}"
                                        Tag="3" />
                                        <MenuItem
                                        Name="QuiclListName4"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName4}"
                                        Tag="4" />
                                        <MenuItem
                                        Name="QuiclListName5"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName5}"
                                        Tag="5" />
                                        <MenuItem
                                        Name="QuiclListName6"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName6}"
                                        Tag="6" />
                                        <MenuItem
                                        Name="QuiclListName7"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName7}"
                                        Tag="7" />
                                        <MenuItem
                                        Name="QuiclListName8"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName8}"
                                        Tag="8" />
                                        <MenuItem
                                        Name="QuiclListName9"
                                        Click="MenuItem_Click_QuickSendList"
                                        Header="{Binding quickListName9}"
                                        Tag="9" />
                                    </MenuItem>
                                </Menu>
                                <Button 
                                    Click="QuiclListHxeButton_Click"
                                    Margin="0,6,6,0"
                                    HorizontalAlignment="Right" 
                                    VerticalAlignment="Center"
                                    Grid.Column="1">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <TextBlock
                                        Text="{DynamicResource QuickSendHex}"
                                        ToolTip="{DynamicResource QuickSendHexTip}"/>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </Grid>
                            <ItemsControl
                                Name="toSendList"
                                VirtualizingPanel.CacheLength="1,2"
                                VirtualizingPanel.CacheLengthUnit="Page"
                                VirtualizingPanel.IsVirtualizing="True"
                                VirtualizingPanel.VirtualizationMode="Recycling">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="0,2,8,0"
                                              Height="28">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="25" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="20" />
                                            </Grid.ColumnDefinitions>
                                            <Grid
                                                Margin="1"
                                                Cursor="Cross"
                                                MouseRightButtonDown="TextBlock_MouseRightButtonDown"
                                                Tag="{Binding}" />
                                            <TextBlock
                                                Grid.Column="0"
                                                Margin="0,7,0,0"
                                                HorizontalAlignment="Center"
                                                Cursor="Cross"
                                                MouseRightButtonDown="TextBlock_MouseRightButtonDown"
                                                Tag="{Binding}"
                                                Text="{Binding id}"
                                                ToolTip="{DynamicResource QuickSendIdTip}" />
                                            <TextBox
                                                Grid.Column="1"
                                                Margin="0,0,2,0"
                                                HorizontalAlignment="Stretch"
                                                Text="{Binding text, UpdateSourceTrigger=PropertyChanged}" />
                                            <Button
                                                Grid.Column="2"
                                                Padding="8,0,8,0"
                                                HorizontalAlignment="Stretch"
                                                Click="QuickSendButton_click"
                                                Content="{Binding commit}"
                                                Cursor="Cross"
                                                MouseRightButtonDown="QuickSendButton_rightClick"
                                                Tag="{Binding}"
                                                ToolTip="{DynamicResource QuickSendButtonTip}" />
                                            <CheckBox
                                                Grid.Column="3"
                                                Margin="2,2,2,2"
                                                HorizontalAlignment="Center"
                                                IsChecked="{Binding hex}" />
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Grid Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Button
                                    Name="quickSendImportButton"
                                    Grid.Column="0"
                                    Margin="10,5,3,3"
                                    HorizontalAlignment="Stretch"
                                    Click="QuickSendImportButton_Click"
                                    Content="{DynamicResource QuickImportButton}" />
                                <Button
                                    Name="quickSendExportButton"
                                    Grid.Column="1"
                                    Margin="3,5,10,3"
                                    HorizontalAlignment="Stretch"
                                    Click="QuickSendExportButton_Click"
                                    Content="{DynamicResource QuickExportButton}" />
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                    <DockPanel 
                        Grid.Row="1"
                        Grid.Column="0"
                        Margin="5,0,5,0">
                        <StatusBar DockPanel.Dock="Bottom">
                            <StatusBar.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="80" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="30" />
                                            <ColumnDefinition Width="30" />
                                            <ColumnDefinition Width="30" />
                                        </Grid.ColumnDefinitions>
                                    </Grid>
                                </ItemsPanelTemplate>
                            </StatusBar.ItemsPanel>
                            <StatusBarItem Grid.Column="0"  Padding="0">
                                <CheckBox
                                        Name="AutomaticSendCheckBox"
						                HorizontalAlignment="Center"
                                        Checked="AutomaticSendCheckBox_Checked" 
                                        Unchecked="AutomaticSendCheckBox_Unchecked"
						                ToolTip="{DynamicResource AutomaticSendCheckBoxTip}"/>
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="1" >
                                <TextBlock
                                        MouseDown="AutomaticSendTextBlock_MouseDown" 
						                ToolTip="{DynamicResource AutomaticSendCheckBoxTip}"
						                Text="{DynamicResource AutomaticSendTextBlockTip}"/>
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="2" Padding="0">
                                <TextBox
                                        Name="AutomaticSendTextBox"
                                        Width ="70"
                                        MaxLength="8"
						                HorizontalAlignment="Stretch"
                                        Text="{Binding automaticSendTimer, UpdateSourceTrigger=PropertyChanged}" />
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="3" Padding="0">
                                <TextBlock
						                HorizontalAlignment="Center"
						                Text="ms"/>
                            </StatusBarItem>
                            <Separator Grid.Column="4" HorizontalAlignment = "Right"/>
                            <StatusBarItem Grid.Column="5" Padding="0">
                                <Button
						                Name="quickAddSendListButton"
                                        Margin="2,0,0,0"
                                        Padding="8,0,8,0"
						                HorizontalAlignment="Center"
						                Click="QuickAddSendListButton_Click"
						                ToolTip="{DynamicResource QuickListAddButtonTip}">
                                    <fa:FontAwesome Name="quickAddSendListIcon1"  Foreground="ForestGreen" Icon="plus" />
                                </Button>
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="6" Padding="0">
                                <Button
						                Name="quickDelSendListButton"
                                        Margin="2,0,0,0"
                                        Padding="8,0,8,0"
						                HorizontalAlignment="Center"
						                Click="QuickDelSendListButton_Click"
						                ToolTip="{DynamicResource QuickListDelLastButtonTip}">
                                    <fa:FontAwesome Name="quickDelSendListIcon1"  Foreground="Teal" Icon="minus" />
                                </Button>
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="7" Padding="0">
                                <Button
						                Name="quickRemoveAllListButton"
                                        Margin="2,0,0,0"
                                        Padding="8,0,8,0"
						                HorizontalAlignment="Center"
						                Click="QuickRemoveAllListButton_Click"
						                ToolTip="{DynamicResource QuickRemoveAllListButtonTip}" >
                                    <fa:FontAwesome Name="quickRemoveAllListIcon1"  Foreground="OrangeRed" Icon="close" />
                                </Button>
                            </StatusBarItem>
                        </StatusBar>
                    </DockPanel>
                </Grid>
            </TabItem>

            <!--  脚本编辑界面  -->
            <TabItem 
                Header="{DynamicResource LuaCard}">
                <Grid>
                    <Grid Name="luaScriptEditorGrid" Visibility="Visible">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <WrapPanel Margin="0,0,0,5" Orientation="Horizontal">
                            <ComboBox
                                Name="luaFileListSend"
                                Width="150"
                                SelectionChanged="LuaFileList_SelectionChanged" />
                            <Button
                                Name="newScriptButton"
                                Margin="2,0,0,0"
                                Padding="8,0,8,0"
                                Click="NewScriptButton_Click"
                                ToolTip="{DynamicResource LuaNewScript}">
                                <Grid>
                                    <fa:FontAwesome Foreground="LightSkyBlue" Icon="File" />
                                    <fa:FontAwesome Icon="FileCodeOutline" />
                                </Grid>
                            </Button>
                            <Button
                                Name="runScriptButton"
                                Margin="2,0,0,0"
                                Padding="8,0,8,0"
                                Click="RunScriptButton_Click"
                                ToolTip="{DynamicResource LuaRunScript}">
                                <fa:FontAwesome Foreground="DarkGreen" Icon="Play" />
                            </Button>
                            <Button
                                Name="openScriptFolderButton"
                                Margin="2,0,0,0"
                                Padding="8,0,8,0"
                                Click="OpenScriptFolderButton_Click"
                                ToolTip="{DynamicResource LuaOpenFolder}">
                                <Grid>
                                    <fa:FontAwesome Foreground="Yellow" Icon="FolderOpen" />
                                    <fa:FontAwesome Icon="FolderOutlinepenOutline" />
                                </Grid>
                            </Button>
                            <Button
                                Name="refreshScriptListButton"
                                Margin="2,0,0,0"
                                Padding="8,0,8,0"
                                Click="RefreshScriptListButton_Click"
                                ToolTip="{DynamicResource LuaRefreshList}">
                                <fa:FontAwesome Foreground="Green" Icon="Refresh" />
                            </Button>
                            <Button
                                Name="apiDocumentButton"
                                Margin="2,0,0,0"
                                Padding="8,0,8,0"
                                Click="ApiDocumentButton_Click"
                                ToolTip="{DynamicResource LuaApiReference}">
                                <fa:FontAwesome Foreground="DarkSlateGray" Icon="Book" />
                            </Button>
                            <Button
                                Name="scriptDeleteButton"
                                Margin="2,0,0,0"
                                Padding="8,0,8,0"
                                Click="DeleteScriptButton_Click"
                                ToolTip="{DynamicResource DeleteScript}">
                                <fa:FontAwesome Foreground="DarkCyan" Icon="trash" />
                            </Button>
                        </WrapPanel>
                        <WrapPanel
                            Name="newLuaFileWrapPanel"
                            Grid.Row="1"
                            Margin="3"
                            Visibility="Collapsed">
                            <TextBlock VerticalAlignment="Center" Text="{DynamicResource LuaFileName}" />
                            <TextBox
                                Name="newLuaFileNameTextBox"
                                Width="Auto"
                                MinWidth="150"
                                MaxLength="20"
                                Text="new script" />
                            <Button
                                Name="newLuaFilebutton"
                                Margin="3,0,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="NewLuaFilebutton_Click"
                                ToolTip="{DynamicResource LuaConfirmCreate}">
                                <fa:FontAwesome Foreground="Green" Icon="Check" />
                            </Button>
                            <Button
                                Name="newLuaFileCancelbutton"
                                Margin="3,0,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="NewLuaFileCancelbutton_Click"
                                ToolTip="{DynamicResource LuaCancel}">
                                <fa:FontAwesome Foreground="Red" Icon="Ban" />
                            </Button>
                        </WrapPanel>
                        <avalonEdit:TextEditor
                            xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
                            Name="textEditorRunScript"
                            Grid.Row="2"
                            FontFamily="Consolas"
                            FontSize="10pt"
                            LostFocus="TextEditorRunScript_LostFocus"
                            ShowLineNumbers="True"
                            TextChanged="textEditorRunScript_TextChanged" />
                    </Grid>
                    <!--  脚本编辑界面END  -->

                    <!--  脚本运行日志界面  -->
                    <Grid Name="luaLogShowGrid" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>
                        <TextBox
                            Name="luaLogTextBox"
                            MinWidth="{Binding logScreenWidth}"
                            VerticalContentAlignment="Top"
                            IsReadOnly="true"
                            MouseLeave="luaLogTextBox_MouseLeave"
                            TextWrapping="Wrap"
                            VerticalScrollBarVisibility="Auto" />
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="auto" />
                            </Grid.ColumnDefinitions>
                            <Button
                                Name="stopLuaButton"
                                Margin="0,3,3,3"
                                Click="StopLuaButton_Click"
                                Foreground="DarkRed"
                                ToolTip="{DynamicResource LuaStop}">
                                <fa:FontAwesome Name="stopLuaOrExitIcon" Icon="Stop" />
                            </Button>
                            <Button
                                Name="reRunLuaButton"
                                Grid.Column="1"
                                Margin="0,3,3,3"
                                Click="reRunLuaButton_Click"
                                Foreground="ForestGreen"
                                ToolTip="{DynamicResource LuaOverload}">
                                <fa:FontAwesome Name="reRunLuaIcon" Icon="Refresh" />
                            </Button>
                            <Button
                                Name="clearLuaPrintButton"
                                Grid.Column="2"
                                Margin="0,3,3,3"
                                Click="ClearLuaPrintButton_Click"
                                Foreground="Peru"
                                ToolTip="{DynamicResource LuaClear}">
                                <fa:FontAwesome Name="clearLuaPrintIcon" Icon="PaintBrush" />
                            </Button>
                            <TextBox
                                Name="runOneLineLuaTextBox"
                                Grid.Column="3"
                                Margin="0,3"
                                KeyDown="RunOneLineLuaTextBox_KeyDown" />
                            <Button
                                Name="sendLuaScriptButton"
                                Grid.Column="4"
                                Margin="3,3,0,3"
                                Click="SendLuaScriptButton_Click"
                                Foreground="DeepSkyBlue"
                                ToolTip="{DynamicResource LuaSendScript}">
                                <fa:FontAwesome Icon="ArrowUp" />
                            </Button>
                        </Grid>
                    </Grid>
                    <!--  脚本运行日志界面END  -->
                </Grid>
            </TabItem>

            <!--  数据监测界面  -->
            <TabItem 
                Header="{DynamicResource DataMonitorCard}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition  Height="*" />
                        <RowDefinition  Height="40" />
                    </Grid.RowDefinitions>
                    <Grid Name="dataMonitorListGrid" Visibility="Visible">
                        <Grid.RowDefinitions>
                            <RowDefinition  Height="20" />
                            <RowDefinition  Height="*" />
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0" Margin="5,2,15,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="65"/>
                                <ColumnDefinition Width="45"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Grid.Column="0"
                                Margin="0,2,0,2"
                                HorizontalAlignment="Center"
                                Text="{DynamicResource DataMonitorChannel}" />
                            <TextBlock
                                Grid.Column="1"
                                Margin="0,2,0,2"
                                HorizontalAlignment="Center"
                                Text="{DynamicResource DataMonitorDescription}" />
                            <TextBlock
                                Grid.Column="2"
                                Margin="0,2,0,2"
                                HorizontalAlignment="Center"
                                Text="{DynamicResource DataMonitorValue}" />
                            <TextBlock
                                Grid.Column="3"
                                Margin="0,2,-20,2"
                                HorizontalAlignment="Center"
                                Text="{DynamicResource DataMonitorSampEn}" />
                        </Grid>
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <ScrollViewer 
                                Name ="MonitorScrollViewer" 
                                VerticalScrollBarVisibility="Visible">
                                <StackPanel>
                                    <ItemsControl
                                        Name="toDataMonitorList"
                                        Margin="0,0,0,0"
                                        VirtualizingPanel.CacheLength="1,2"
                                        VirtualizingPanel.CacheLengthUnit="Page"
                                        VirtualizingPanel.IsVirtualizing="True"
                                        VirtualizingPanel.VirtualizationMode="Recycling">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,4,12,0"
                                                      Height="28"
                                                      Visibility ="{Binding visibility, UpdateSourceTrigger=PropertyChanged}">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="25" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="25"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock
                                                        Grid.Column="0"
                                                        Margin="0,7,2,0"
                                                        HorizontalAlignment="Center"
                                                        Text="{Binding channel}" />
                                                    <TextBox
                                                        Grid.Column="1"
                                                        Margin="0,0,2,0"
                                                        MaxLength="100"
                                                        HorizontalAlignment="Stretch"
                                                        Text="{Binding description, UpdateSourceTrigger=PropertyChanged}" />
                                                    <TextBox
                                                        Grid.Column="2"
                                                        Margin="0,0,2,0"
                                                        HorizontalAlignment="Stretch"
                                                        IsReadOnly="True" 
                                                        MaxLength="50"
                                                        Text="{Binding result, UpdateSourceTrigger=PropertyChanged}" />
                                                    <CheckBox
                                                        Grid.Column="3"
                                                        Margin="0,0,2,0"
                                                        HorizontalAlignment="Center"
                                                        Click="dataMonitorSampleEn_click"
                                                        Tag="{Binding}"
                                                        IsChecked="{Binding sampleEn, UpdateSourceTrigger=PropertyChanged}" />
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>

                                    <Grid Margin="0,10,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition Width="auto" />
                                        </Grid.ColumnDefinitions>

                                        <Button
                                            Name="monitorClearValueButton"
                                            Grid.Column="0"
                                            Margin="5,3,3,3"
                                            HorizontalAlignment="Stretch"
                                            Click="MonitorClearValueButton_Click"
                                            Content="{DynamicResource MonitorClearValueButton}" />
                                        
                                        <Button
                                            Margin="2,0,2,0"
                                            Padding="8,0,8,0"
                                            Grid.Column="1"
                                            Name="monitorAddSendListButton"
                                            Click="MonitorAddSendListButton_Click"
                                            ToolTip="{DynamicResource MonitorListAddButton}">
                                            <fa:FontAwesome 
                                                Name="monitorAddSendListIcon" 
                                                Foreground="ForestGreen" 
                                                Icon="plus"/>
                                        </Button>

                                        <Button
                                            Margin="2,0,2,0"
                                            Padding="8,0,8,0"
                                            Grid.Column="2"
                                            Name="monitorDelSendListButton"
                                            Click="MonitorDelSendListButton_Click"
                                            ToolTip="{DynamicResource MonitorListDelLastButton}">
                                            <fa:FontAwesome 
                                                Name="monitorDelSendListIcon" 
                                                Foreground="Teal" 
                                                Icon="minus"/>
                                        </Button>

                                        <Button
                                            Margin="2,0,7,0"
                                            Padding="8,0,8,0"
                                            Grid.Column="3"
                                            Name="monitorRemoveAllListButton"
                                            Click="MonitorRemoveAllListButton_Click"
                                            ToolTip="{DynamicResource MonitorRemoveAllListButton}">
                                            <fa:FontAwesome 
                                                Name="monitorRemoveAllListIcon" 
                                                Foreground="OrangeRed" 
                                                Icon="close"/>
                                        </Button>
                                    </Grid>
                                    <Grid Margin="0,0,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                                Name="monitorSendImportButton"
                                                Grid.Column="0"
                                                Margin="5,3,1,3"
                                                HorizontalAlignment="Stretch"
                                                Click="MonitorSendImportButton_Click"
                                                Content="{DynamicResource MonitorImportButton}" />
                                        <Button
                                                Name="monitorSendExportButton"
                                                Grid.Column="1"
                                                Margin="3,3,7,3"
                                                HorizontalAlignment="Stretch"
                                                Click="MonitorSendExportButton_Click"
                                                Content="{DynamicResource MonitorExportButton}" />
                                    </Grid>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </Grid>

                    <!--  脚本编辑界面  -->
                    <Grid Name="dataMonitorScriptEditGrid" Visibility="Collapsed">
                        <avalonEdit:TextEditor
                            xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
                            Name="dataMonitorScriptEdit"
                            Grid.Row="0"
                            FontFamily="Consolas"
                            FontSize="10pt"
                            LostFocus="TextEditorDataMonitor_LostFocus"
                            ShowLineNumbers="True"
                            TextChanged="textEditorDataMonitor_TextChanged" />
                    </Grid>

                    <Grid Name="dataMonitorLogGrid" Visibility="Collapsed">
                        <TextBox
                            Name="dataMonitorLogTextBox"
                            MinWidth="{Binding logScreenWidth}"
                            VerticalContentAlignment="Top"
                            IsReadOnly="true"
                            MouseLeave="dataMonitorLogTextBox_MouseLeave"
                            TextWrapping="Wrap"
                            VerticalScrollBarVisibility="Auto" />
                    </Grid>
                    <DockPanel 
                        Grid.Row="1"
                        Grid.Column="0"
                        Margin="5,0,5,0">
                        <StatusBar DockPanel.Dock="Bottom">
                            <StatusBar.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="35" />
                                        </Grid.ColumnDefinitions>
                                    </Grid>
                                </ItemsPanelTemplate>
                            </StatusBar.ItemsPanel>
                            <StatusBarItem Grid.Column="0"  Padding="0" HorizontalContentAlignment="Stretch">
                                <Button
                                    Name="dataMonitorScriptRunButton"
                                    Click="dataMonitorScriptRunButton_Click"
                                    HorizontalAlignment="Stretch"
                                    Margin="0,0,0,0"
                                    Width="{Binding ActualWidth, ElementName=StatusBarItemContainer}" 
                                    Content="{DynamicResource DataMonitorScriptRun}" />
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="1"  Padding="0">
                                <Button
                                    Margin="5,0,0,0"
                                    Padding="8,0,8,0"
                                    Name="dataMonitorLogButton"
                                    Click="dataMonitorLogButton_Click"
                                    ToolTip="{DynamicResource DataMonitorLog}">
                                    <fa:FontAwesome Name="dataMonitorLogIcon"  Foreground="Firebrick" Icon="Wpforms" />
                                </Button>
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="2"  Padding="0">
                                <Button
                                    Margin="2,0,0,0"
                                    Padding="8,0,8,0"
                                    Name="dataMonitorScriptEditButton"
                                    Click="dataMonitorScriptEditButton_Click"
                                    ToolTip="{DynamicResource DataMonitorScriptEdit}">
                                    <fa:FontAwesome Name="dataMonitorScriptEditIcon"  Foreground="ForestGreen" Icon="code" />
                                </Button>
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="3"  Padding="0">
                                <Button
                                    Margin="2,0,0,0"
                                    Padding="8,0,8,0"
                                    Name="dataMonitorOpenLogButton"
                                    Click="dataMonitorOpenLogButton_Click"
                                    ToolTip="{DynamicResource DataMonitorOpenLog}">
                                    <Grid>
                                        <fa:FontAwesome Name="dataMonitorOpenLogIcon"  Foreground="Yellow" Icon="FolderOpen" />
                                        <fa:FontAwesome Icon="FolderOutlinepenOutline" />
                                    </Grid>
                                </Button>
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="4"  Padding="0">
                                <Button
                                    Margin="2,0,0,0"
                                    Padding="8,0,8,0"
                                    Name="dataMonitorSelectShowButton"
                                    Click="dataMonitorSelectShowButton_Click"
                                    ToolTip="{DynamicResource DataMonitorSelectShow}">
                                    <fa:FontAwesome 
                                        Name="dataMonitorSelectShowIcon"   
                                        Foreground="DarkCyan" 
                                        Icon="{Binding selectShowSw,Converter={StaticResource DataMonitorSelectShowConverter}}" />
                                </Button>
                            </StatusBarItem>
                            <StatusBarItem Grid.Column="5"  Padding="0">
                                <Button
                                    Margin="1,0,0,0"
                                    Padding="8,0,8,0"
                                    Name="dataMonitorAllSelectButton"
                                    Click="dataMonitorAllSelectButton_Click"
                                    ToolTip="{DynamicResource DataMonitorAllSelect}">
                                    <fa:FontAwesome 
                                        Name="dataMonitorAllSelectIcon" 
                                        Foreground="DimGray" 
                                        Icon="{Binding allSelectSw,Converter={StaticResource DataMonitorAllSelectConverter}}"/>
                                </Button>
                            </StatusBarItem>
                        </StatusBar>
                    </DockPanel>
                </Grid>
            </TabItem>

            <!--  抓图工具界面  -->
            <TabItem 
                Header="{DynamicResource GraphTool}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="27*"/>
                        <ColumnDefinition Width="85*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition  Height="*" />
                        <RowDefinition  Height="35" />
                    </Grid.RowDefinitions>
                    <Grid Name="graphToolListGrid" Visibility="Visible" Grid.ColumnSpan="2">
                        <Grid.RowDefinitions>
                            <RowDefinition  Height="*" />
                            <RowDefinition  Height="Auto" />
                        </Grid.RowDefinitions>
                        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition  Height="20" />
                                    <RowDefinition  Height="*" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0" Margin="4,4,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" MinWidth="120"/>
                                        <ColumnDefinition Width="85"/>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock
								        Grid.Column="0"
								        HorizontalAlignment="Center"
								        Text="{DynamicResource GraphShow}" />
                                    <TextBlock
								        Grid.Column="1"
								        HorizontalAlignment="Center"
								        Text="{DynamicResource GraphDescription}" />
                                    <TextBlock
								        Grid.Column="2"
								        HorizontalAlignment="Center"
								        Text="{DynamicResource GraphDataSource}" />
                                    <TextBlock
								        Grid.Column="3"
								        HorizontalAlignment="Center"
								        Text="{DynamicResource GraphType}" />
                                    <TextBlock
								        Grid.Column="4"
								        HorizontalAlignment="Center"
								        Text="{DynamicResource GraphZoom}" />
                                    <TextBlock
								        Grid.Column="5"
								        HorizontalAlignment="Center"
								        Text="{DynamicResource GraphOffset}" />
                                </Grid>
                                <Grid Grid.Row="1">
                                    <StackPanel>
                                        <ItemsControl
									        Name="toSnatchGraphList"
									        VirtualizingPanel.IsVirtualizing="True"
									        VirtualizingPanel.VirtualizationMode="Recycling">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid 
                                                        Height="28"
                                                        Margin="1,4,0,0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" MinWidth="120"/>
                                                            <ColumnDefinition Width="85"/>
                                                            <ColumnDefinition Width="80"/>
                                                            <ColumnDefinition Width="50"/>
                                                            <ColumnDefinition Width="50"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock
													        Grid.Column="0"
													        HorizontalAlignment="Center"
													        Visibility="Collapsed"
													        Text="{Binding channel}" />
                                                        <CheckBox
													        Grid.Column="0"
													        Margin="4,2,4,2"
													        HorizontalAlignment="Center"
													        Click="graphShow_Click"
													        Tag="{Binding}"
													        IsChecked="{Binding show}" />
                                                        <TextBox
													        Grid.Column="1"
                                                            Margin="0,0,2,0"
                                                            MaxLength="25"
													        HorizontalAlignment="Stretch"
													        Text="{Binding description, UpdateSourceTrigger=PropertyChanged}" />
                                                        <TextBox
													        Grid.Column="2"
                                                            Margin="0,0,2,0"
                                                            MaxLength="20"
													        HorizontalAlignment="Stretch"
													        Text="{Binding dataSour, UpdateSourceTrigger=PropertyChanged}" />
                                                        <ComboBox 
													        Grid.Column="3"
                                                            Margin="0,0,2,0"
													        HorizontalAlignment="Stretch"
													        Name="snatchGraphTypeComboBox" 
													        SelectedIndex="{Binding type}">
                                                            <ComboBoxItem Content="INT8S"/>
                                                            <ComboBoxItem Content="INT8U"/>
                                                            <ComboBoxItem Content="INT16S"/>
                                                            <ComboBoxItem Content="INT16U"/>
                                                            <ComboBoxItem Content="INT32S"/>
                                                            <ComboBoxItem Content="INT32U"/>
                                                            <ComboBoxItem Content="FLOAT"/>
                                                            <ComboBoxItem Content="DOUBLE"/>
                                                        </ComboBox>
                                                        <TextBox
													Grid.Column="4"
                                                    Margin="0,0,2,0"
													HorizontalAlignment="Stretch"
													LostFocus="graphScaleY_LostFocus"
													PreviewKeyDown="graphScaleY_PreviewKeyDown"
													Tag="{Binding}"
													Text="{Binding scaleY, UpdateSourceTrigger=PropertyChanged}" />
                                                        <TextBox
													Grid.Column="5"
                                                    Margin="0,0,2,0"
													HorizontalAlignment="Stretch"
													LostFocus="graphOffset_LostFocus"
													PreviewKeyDown="graphOffset_PreviewKeyDown"
													Tag="{Binding}"
													Text="{Binding offset, UpdateSourceTrigger=PropertyChanged}" />
                                                    </Grid>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </Grid>
                            </Grid>
                        </ScrollViewer>
                        <Grid Grid.Row="1">
                            <Grid.RowDefinitions>
                                <RowDefinition  Height="18" />
                                <RowDefinition  Height="35" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" MinWidth="50"/>
                                <ColumnDefinition Width="*" MinWidth="50"/>
                                <ColumnDefinition Width="*" MinWidth="50"/>
                                <ColumnDefinition Width="*" MinWidth="50"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock 
                                Grid.Row="0" 
                                Grid.Column="0" 
                                Margin="5,2,0,0" 
                                VerticalAlignment="Center" 
                                Text="{DynamicResource GraphSampleLength}" />
                            <TextBlock 
                                Grid.Row="0" 
                                Grid.Column="1" 
                                Margin="5,2,0,0" 
                                VerticalAlignment="Center" 
                                Text="{DynamicResource GraphSampleInterval}" />
                            <TextBlock 
                                Grid.Row="0" 
                                Grid.Column="2" 
                                Margin="5,2,0,0" 
                                VerticalAlignment="Center" 
                                Text="{DynamicResource GraphTriggerParameter}" />
                            <TextBlock 
                                Grid.Row="0" 
                                Grid.Column="3" 
                                Margin="5,2,0,0" 
                                VerticalAlignment="Center" 
                                Text="{DynamicResource GraphTriggerLag}" />
                            <TextBox 
                                Grid.Row="1" 
                                Grid.Column="0" 
                                MaxLength="4"
                                Height="28"
                                Margin="5,0,5,0" 
                                Name="graphToolSampleLenTextBox"
                                Text="{Binding graphToolSampleLen, UpdateSourceTrigger=PropertyChanged}" />
                            <TextBox 
                                Grid.Row="1" 
                                Grid.Column="1" 
                                MaxLength="4"
                                Height="28"
                                Margin="5,0,5,0" 
                                Name="graphToolSampleIntervalTextBox"
                                Text="{Binding graphToolSampleInterval, UpdateSourceTrigger=PropertyChanged}" />
                            <TextBox 
                                Grid.Row="1" 
                                Grid.Column="2" 
                                MaxLength="4"
                                Height="28"
                                Margin="5,0,5,0" 
                                Name="graphToolTriggerParaTextBox"
                                Text="{Binding graphToolTriggerPara, UpdateSourceTrigger=PropertyChanged}" />
                            <TextBox 
                                Grid.Row="1" 
                                Grid.Column="3" 
                                MaxLength="4"
                                Height="28"
                                Margin="5,0,5,0" 
                                Name="graphToolTriggerLagTextBox"
                                Text="{Binding graphToolTriggerLag, UpdateSourceTrigger=PropertyChanged}" />
                        </Grid>
                    </Grid>

                    <!--  脚本编辑界面  -->
                    <Grid Name="graphToolScriptEditGrid" Visibility="Collapsed" Grid.ColumnSpan="2">
                        <avalonEdit:TextEditor
                            xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
                            Name="graphToolScriptEdit"
                            Grid.Row="0"
                            FontFamily="Consolas"
                            FontSize="10pt"
                            LostFocus="TextEditorGraphTool_LostFocus"
                            ShowLineNumbers="True"
                            TextChanged="textEditorrGraphTool_TextChanged" />
                    </Grid>

                    <Grid Name="graphToolLogGrid" Visibility="Collapsed" Grid.ColumnSpan="2">
                        <TextBox
                            Name="graphToolLogTextBox"
                            MinWidth="{Binding logScreenWidth}"
                            VerticalContentAlignment="Top"
                            IsReadOnly="true"
                            MouseLeave="graphToolLogTextBox_MouseLeave"
                            TextWrapping="Wrap"
                            VerticalScrollBarVisibility="Auto" />
                    </Grid>

                    <Grid Grid.Row="1" Margin="5,0,4,6" Grid.ColumnSpan="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="35" />
                            <ColumnDefinition Width="35" />
                        </Grid.ColumnDefinitions>
                        <Button
                            Name="graphScriptRunButton"
                            Grid.Column="0"
                            HorizontalAlignment="Stretch"
                            Click="graphScriptRunButton_Click"
                            Content="{DynamicResource GraphScriptRun}" />
                        <ComboBox 
                            Grid.Column="1"
                            Margin="4,0,0,0"
                            Height="28"
                            Name="graphToolModeComboBox"
                            SelectedIndex ="{Binding graphToolSampleMode, UpdateSourceTrigger=PropertyChanged}">
                            <ComboBoxItem Content="{DynamicResource GraphFastSample}"/>
                            <ComboBoxItem Content="{DynamicResource GraphFaultTrigger}"/>
                            <ComboBoxItem Content="{DynamicResource GraphEventTrigger}"/>
                            <ComboBoxItem Content="{DynamicResource GraphScatterSample}"/>
                        </ComboBox>
                        <Button
                            Name="GraphLogButto1n"
                            Grid.Column="2"
                            Margin="2,0,0,0"
                            Padding="8,0,8,0"
                            ToolTip="{DynamicResource GraphLog}"
                            Click="graphLogButton_Click">
                            <fa:FontAwesome Name="GraphLogIcon1"  Foreground="Firebrick" Icon="Wpforms" />
                        </Button>
                        <Button
                            Name="GraphScriptEditButto1n"
                            Grid.Column="3"
                            Margin="2,0,0,0"
                            Padding="8,0,8,0"
                            ToolTip="{DynamicResource GraphEditScript}"
                            Click="graphEditScriptButton_Click">
                            <fa:FontAwesome Name="GraphScriptEditIcon1"  Foreground="ForestGreen" Icon="code" />
                        </Button>
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>

        <StackPanel
            Grid.Column="0"
            Grid.Row="0"
            HorizontalAlignment="Right"
            Orientation="Horizontal">
            <Button  
                BorderThickness="0"
                Click="Language_Click"
                Margin="0, 3, 0, 0"
                HorizontalAlignment="Right"
                ToolTip="{DynamicResource ChangeLanguage}"
                VerticalAlignment="Top">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <ContentPresenter />
                    </ControlTemplate>
                </Button.Template>
                <Grid>
                    <fa:FontAwesome 
                        Foreground="CornflowerBlue" 
                        Icon="Globe">
                        <fa:FontAwesome.Style>
                            <Style TargetType="fa:FontAwesome">
                                <Setter Property="FontSize" Value="17" />
                            </Style>
                        </fa:FontAwesome.Style>
                    </fa:FontAwesome>
                </Grid>
            </Button>
            <Button
                BorderThickness="0"
                Grid.Column="0"
                Grid.Row="0"
                Click="GraphSwButton_Click"
                Width="35" 
                Margin="0, 3, 0, 0"
                HorizontalAlignment="Right"
                ToolTip="{DynamicResource GraphSwButton}"
                VerticalAlignment="Top">

                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <ContentPresenter />
                    </ControlTemplate>
                </Button.Template>

                <Grid>
                    <fa:FontAwesome
                        Name="graphSwIcon"
                        Icon="{Binding graphSw, Converter={StaticResource GraphSwIconConverter}}"
                        Foreground="CornflowerBlue" 
                        Visibility="Visible">
                        <fa:FontAwesome.Style>
                            <Style TargetType="fa:FontAwesome">
                                <Setter Property="FontSize" Value="17" />
                            </Style>
                        </fa:FontAwesome.Style>
                    </fa:FontAwesome>
                </Grid>
            </Button>
        </StackPanel>

        <!--  中间改变分割大小的东西  -->
        <GridSplitter
            x:Name="MainGridSplitter"
            Grid.RowSpan="2"
            Grid.Column="1"
            Background="white"
            HorizontalAlignment="Stretch"/>

        <!--  收发数据显示和Graph  -->
        <Grid 
            Name="GraphTextGrid" 
            Grid.MinWidth="550"
            Grid.RowSpan="2"
            Grid.Row="0"
            Grid.Column="2" Cursor="">

            <Frame 
                Name="PlotFrame"
                Margin="0,0,-8,4"
                BorderThickness="0"
                NavigationUIVisibility="Hidden"
                Visibility="{Binding graphSw, Converter={StaticResource boolVisibeConverter}}"/>

            <Frame
                Name="dataShowFrame"
                Margin="0,0,5,4"
                BorderThickness="0"
                NavigationUIVisibility="Hidden"
                Visibility="{Binding graphSw, Converter={StaticResource boolNotVisibeConverter}}"/>
        </Grid>

        <!--  发送数据区  -->
        <Grid 
            Name="DataSendGrid" 
            Grid.Row="1" 
            Grid.Column="0"
            Grid.ColumnSpan="1"
            Margin="6,2,0,2">
            <Grid.RowDefinitions>
                <RowDefinition Height="30" />
                <RowDefinition Height="30" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0" />
                <ColumnDefinition Width="0" />
                <ColumnDefinition Width="0" />
                <ColumnDefinition Width="55" />
                <ColumnDefinition Width="75" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="50" />
            </Grid.ColumnDefinitions>
            <Button
                Name="openClosePortButton"
                Grid.RowSpan="2"
                Grid.Column="3"
                Height="56"
                HorizontalAlignment="Stretch"
                Padding="2"
                Click="OpenClosePortButton_Click">
                <StackPanel>
                    <TextBlock Name="openClosePortTextBlock" Text="{DynamicResource OpenPort_open}" />
                    <TextBlock Text="{DynamicResource OpenPort_port}" />
                </StackPanel>
            </Button>
            <Button
                Name="clearLogButton"
                Grid.Row="0"
                Grid.Column="4"
                Height="26"
                HorizontalAlignment="Stretch"
                Padding="0"
                Margin="2,2,0,2"
                Click="ClearLogButton_Click"
                Content="{DynamicResource ClearLog}" />
            <Button
                Name="MoreSettingButton"
                Grid.Row="1"
                Grid.Column="4"
                Height="26"
                HorizontalAlignment="Stretch"
                Padding="0"
                Margin="2,2,0,2"
                Click="MoreSettingButton_Click"
                Content="{DynamicResource MoreSettings}"/>
            <TextBox
                Name="toSendDataTextBox"
                Grid.RowSpan="2"
                Grid.Column="5"
                Margin="2"
                VerticalContentAlignment="Top"
                AcceptsReturn="True"
                FontFamily="Consolas"
                Text="{Binding dataToSend}"
                TextWrapping="Wrap"
                VerticalScrollBarVisibility="Auto" />
            <Button
                Name="sendDataButton"
                Grid.RowSpan="2"
                Grid.Column="6"
                Height="56"
                HorizontalAlignment="Stretch"
                Margin="0"
                Command="{StaticResource SendUartData}"
                ToolTip="{DynamicResource SendDataButtonTip}">

                <fa:FontAwesome 
                        Foreground="CornflowerBlue" 
                        Icon="paperplane">
                    <fa:FontAwesome.Style>
                        <Style TargetType="fa:FontAwesome">
                            <Setter Property="FontSize" Value="20" />
                            <!-- 设置图标大小 -->
                        </Style>
                    </fa:FontAwesome.Style>
                </fa:FontAwesome>
            </Button>
        </Grid>

        <!--  底部状态栏  -->
        <DockPanel Grid.Row="2" Grid.ColumnSpan="3">
            <StatusBar DockPanel.Dock="Bottom">
                <StatusBar.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                        </Grid>
                    </ItemsPanelTemplate>
                </StatusBar.ItemsPanel>
                <Button
                    Name="refreshPortButton"
                    Grid.Column="0"
                    Click="RefreshPortButton_Click"
                    Content="{DynamicResource RefreshPortButton}"
                    IsEnabled="{Binding ElementName=serialPortsListComboBox, Path=IsEnabled}" />
                <Separator Grid.Column="1" />
                <StatusBarItem Grid.Column="2">
                    <TextBlock Text="{DynamicResource ShowPorts}" />
                </StatusBarItem>
                <StatusBarItem Grid.Column="3">
                    <ComboBox
                        Padding="5,0,2,0"
                        Name="serialPortsListComboBox"
                        MinWidth="150"
                        MaxWidth="240" />
                </StatusBarItem>
                <Separator Grid.Column="4" />
                <StatusBarItem Grid.Column="5">
                    <TextBlock Text="{DynamicResource ShowBaudRate}" />
                </StatusBarItem>
                <StatusBarItem Grid.Column="6">
                    <ComboBox
                        Name="baudRateComboBox"
                        Width="100"
                        DropDownOpened="BaudRateComboBox_DropDownOpened"
                        DropDownClosed="BaudRateComboBox_DropDownClosed">
                        <ComboBoxItem Content="110" />
                        <ComboBoxItem Content="330" />
                        <ComboBoxItem Content="600" />
                        <ComboBoxItem Content="1200" />
                        <ComboBoxItem Content="2400" />
                        <ComboBoxItem Content="4800" />
                        <ComboBoxItem Content="9600" />
                        <ComboBoxItem Content="14400" />
                        <ComboBoxItem Content="19200" />
                        <ComboBoxItem Content="38400" />
                        <ComboBoxItem Content="56000" />
                        <ComboBoxItem Content="57600" />
                        <ComboBoxItem Content="115200" />
                        <ComboBoxItem Content="128000" />
                        <ComboBoxItem Content="230400" />
                        <ComboBoxItem Content="256000" />
                        <ComboBoxItem Content="460800" />
                        <ComboBoxItem Content="500000" />
                        <ComboBoxItem Content="128000" />
                        <ComboBoxItem Content="512000" />
                        <ComboBoxItem Content="600000" />
                        <ComboBoxItem Content="750000" />
                        <ComboBoxItem Content="921600" />
                        <ComboBoxItem Content="1000000" />
                        <ComboBoxItem Content="1500000" />
                        <ComboBoxItem Content="2000000" />
                        <ComboBoxItem Content="3000000" />
                        <ComboBoxItem Content="{DynamicResource OtherRate}" />
                    </ComboBox>
                </StatusBarItem>
                <Separator Grid.Column="7" HorizontalAlignment = "Right"/>
                <StatusBarItem Grid.Column="8" HorizontalAlignment = "Right">
                    <TextBlock
                        Cursor="Cross"
                        MouseRightButtonDown="sentCountTextBlock_MouseRightButtonDown"
                        Text="{DynamicResource SentCount}"
                        ToolTip="{DynamicResource ClearCountTip}" />
                </StatusBarItem>
                <StatusBarItem Grid.Column="9" HorizontalAlignment = "Right">
                    <TextBlock
                        Margin="0, 0, 10, 0"
                        Name="sentCountTextBlock"
                        Cursor="Cross"
                        MouseRightButtonDown="sentCountTextBlock_MouseRightButtonDown"
                        Text="{Binding SentCount}"
                        ToolTip="{DynamicResource ClearCountTip}" />
                </StatusBarItem>
                <Separator Grid.Column="10" HorizontalAlignment = "Right"/>
                <StatusBarItem Grid.Column="11" HorizontalAlignment = "Right">
                    <TextBlock
                        Cursor="Cross"
                        MouseRightButtonDown="receivedCountTextBlock_MouseRightButtonDown"
                        Text="{DynamicResource ReceivedCount}"
                        ToolTip="{DynamicResource ClearCountTip}" />
                </StatusBarItem>
                <StatusBarItem Grid.Column="12"  HorizontalAlignment = "Right">
                    <TextBlock
                        Margin="0, 0, 10, 0"
                        Name="receivedCountTextBlock"
                        Cursor="Cross"
                        MouseRightButtonDown="receivedCountTextBlock_MouseRightButtonDown"
                        Text="{Binding ReceivedCount}"
                        ToolTip="{DynamicResource ClearCountTip}" />
                </StatusBarItem>
            </StatusBar>
        </DockPanel>
    </Grid>
</Window>
